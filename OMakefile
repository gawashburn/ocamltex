# End user configuration
LATEX = pdflatex
OCAMLSRC=/local/src/ocaml-3.08.4

# OCamlTeX configuration
OCAMLTEX = ./ocamltex --latex=$(LATEX)

# OCaml configuration
BYTE_ENABLED = true
NATIVE_ENABLED = false
CSTRLIBDIR = +/site-lib/cstr
CASHLIBDIR = +/site-lib/cash
PCRELIBDIR = +/site-lib/pcre
OTLIBS = stdlib.cma camlp4.cma unix.cma cstr.cma pcre.cma str.cma toplevellib.cma cash.cma errors.cmo
OCAMLFLAGS += -I +camlp4 -I +site-lib/cstr -I +site-lib/pcre -I +site-lib/cash \
 -I $(OCAMLSRC)/driver $(OTLIBS)
	
ocamltex.ml ocamltex.sty: ocamltex.dtx ocamltex.ins
	$(LATEX) ocamltex.ins

ocamltex.pdf: ocamltex ocamltex.sty ocamltex.dtx
	$(LATEX) ocamltex.dtx

OCamlProgram(ocamltex, ocamltex)


.DEFAULT: ocamltex ocamltex.sty 

.PHONY: clean test

clean:
	$(RM) *.o *.aux *.log *.idx *.out *.cmo *.cmi *.cmx *.glo ocamltex.ml *.pdf ocamltex.sty \
        ocamltex.run *.??ml ocamltex

test: ocamltex ocamltex.sty
        $(OCAMLTEX) testing.tex
